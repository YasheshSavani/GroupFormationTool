<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="ISO-8859-1">
    <link rel="stylesheet" th:href="@{/css/main.css}"/>
    <link
            href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M"
            crossorigin="anonymous">
    <link
            href="https://getbootstrap.com/docs/4.0/examples/signin/signin.css"
            rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/theme.css}"/>
    <title>Forgot Password</title>
    <script type="text/javascript">
        function validate() {
            var minLength = "[[${passwordProperties.getMinLength()}]]";
            var maxLength = "[[${passwordProperties.getMaxLength()}]]";
            var minUpperCase = "[[${passwordProperties.getMinUpperCase()}]]";
            var minLowerCase = "[[${passwordProperties.getMinLowerCase()}]]";
            var minSpecialChars = "[[${passwordProperties.getMinSpecialChars()}]]";
            var invalidChars = "[[${passwordProperties.getInvalidChars()}]]";
            var minUpperCaseChecker = new RegExp(`^(.*?[A-Z]){${minUpperCase},}`);
            var minLowerCaseChecker = new RegExp(`^(.*?[a-z]){${minLowerCase},}`);
            var minSpecialCharsChecker = new RegExp(
                `^(.*?[!@#\$%\^\&*\)\(+=._-]){${minSpecialChars},}`);
            var invalidCharsChecker = new RegExp(`^[^${invalidChars}]*$`);

            if (document.resetPasswordForm.password.value.length < minLength) {
                alert(`Password should be atleast ${minLength} characters`);
                document.resetPasswordForm.password.focus();
                return false;
            }

            if (document.resetPasswordForm.password.value.length > maxLength) {
                alert(`Password should be atmost ${maxLength} characters`);
                document.resetPasswordForm.password.focus();
                return false;
            }

            if (!minUpperCaseChecker
                .test(document.resetPasswordForm.password.value)) {
                alert(`Password should have atleast ${minUpperCase} uppercase characters`);
                document.resetPasswordForm.password.focus();
                return false;
            }

            if (!minLowerCaseChecker
                .test(document.resetPasswordForm.password.value)) {
                alert(`Password should have atleast ${minLowerCase} lowercase characters`);
                document.resetPasswordForm.password.focus();
                return false;
            }

            if (!invalidCharsChecker
                .test(document.resetPasswordForm.password.value)) {
                alert(`Password cannot contain the characters: ${invalidChars}`);
                document.resetPasswordForm.password.focus();
                return false;
            }

            if (!minSpecialCharsChecker
                .test(document.resetPasswordForm.password.value)) {
                alert(`Password should have atleast ${minSpecialChars} special characters`);
                document.resetPasswordForm.password.focus();
                return false;
            }

            if (document.resetPasswordForm.password.value == "") {
                alert("Please provide your password!");
                document.resetPasswordForm.password.focus();
                return false;
            }
            if (document.resetPasswordForm.confirmPassword.value == "") {
                alert("Please confirm your password!");
                document.resetPasswordForm.confirmPassword.focus();
                return false;
            }

            if (document.resetPasswordForm.password.value != document.resetPasswordForm.confirmPassword.value) {
                alert("Passwords do not match!");
                document.resetPasswordForm.confirmPassword.focus();
                return false;
            }
            console.log(minLength);
            return true;
        }
    </script>
</head>
<body>
<ul>
    <li class="reset"><a href="#resetPassword"
                         style="text-align: center"> GroupMe </a></li>

</ul>

<div class="container">

    <h2 style="text-align: center">Reset Password</h2>
    <form name="resetPasswordForm" onSubmit="return validate();"
          th:action="@{/resetPassword}" method="post"
          class="custom-form-control">

        <p>
            <input type="text" id="email" name="email" placeholder="Email"
                   required="true" autofocus="true" th:value="${email}"/>
        </p>

        <p>
            <input type="password" id="password" name="password"
                   placeholder="Password" required="true" autofocus="true"/>
        </p>

        <p>
            <input type="password" id="confirm" name="confirmPassword"
                   placeholder="Confirm Password" required="true" autofocus=""/>
        </p>

        <button class="btn btn-lg btn-primary btn-block btn-submit"
                type="submit">Submit
        </button>

        <button class="btn btn-lg btn-primary btn-block btn-submit"
                type="reset">Clear
        </button>


    </form>
    <p1 style="text-align: center" class="text-center"
        th:text="${message}"></p1>

</div>

<!-- <form name="resetPasswordForm" onSubmit="return (validate());"
    th:action="@{/resetPassword}" method="post">

    <table style="margin-left: auto; margin-right: auto;">
        <tr>
            <td colspan="2"><h3 style="text-align: center">Enter new
                    password</h3></td>
        </tr>
        <tr>
            <td align="right">Email</td>
            <td><input type="email" name="email" th:value="${email}"/></td>
        </tr>
        <tr>
            <td align="right">Password</td>
            <td><input type="password" name="password" /></td>
        </tr>
        <tr>
            <td align="right">Confirm Password</td>
            <td><input type="password" name="confirmPassword" /></td>
        </tr>
        <tr>
            <td align="right"></td>
            <td><input type="submit" value="Submit" /></td>
        </tr>
    </table>
</form> -->
</body>
</html>